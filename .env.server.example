# Production Server Configuration
# 复制此文件为 .env.production 并根据需要调整

# ============================================
# Server Configuration
# ============================================

# Server port
PORT=3000

# Node environment
NODE_ENV=production

# ============================================
# Asset Preloading Configuration
# ============================================

# Maximum file size to preload into memory (bytes)
# 默认: 2MB (优化后)
# 建议: 
#   - 小型项目: 1-2MB
#   - 中型项目: 2-5MB
#   - 大型项目: 5-10MB
ASSET_PRELOAD_MAX_SIZE=2097152

# Include patterns (comma-separated glob patterns)
# 示例: "*.js,*.css,*.woff2"
# 留空则包含所有文件
ASSET_PRELOAD_INCLUDE_PATTERNS=

# Exclude patterns (comma-separated glob patterns)
# 示例: "*.map,*.txt,*.md"
# 排除 source maps 和大型资源文件
ASSET_PRELOAD_EXCLUDE_PATTERNS=*.map,*.txt,*.md,*.svg

# Verbose logging (显示详细的文件加载信息)
# 开发时设置为 true，生产环境设置为 false
ASSET_PRELOAD_VERBOSE_LOGGING=false

# ============================================
# ETag Configuration
# ============================================

# Enable ETag generation for cache validation
# 推荐: true (提升缓存效率)
ASSET_PRELOAD_ENABLE_ETAG=true

# ============================================
# Gzip Compression Configuration
# ============================================

# Enable Gzip compression
# 推荐: true (减少传输大小)
ASSET_PRELOAD_ENABLE_GZIP=true

# Minimum file size for Gzip compression (bytes)
# 默认: 1KB
# 小于此大小的文件不压缩（压缩反而增加开销）
ASSET_PRELOAD_GZIP_MIN_SIZE=1024

# MIME types eligible for Gzip compression (comma-separated)
# 默认包含常见的可压缩类型
ASSET_PRELOAD_GZIP_MIME_TYPES=text/,application/javascript,application/json,application/xml,image/svg+xml

# ============================================
# Performance Monitoring
# ============================================

# Enable performance logging
# 开发/调试时设置为 true，生产环境设置为 false
ENABLE_PERF_LOGGING=false

# Slow request threshold (milliseconds)
# 超过此时间的请求会被记录为警告
# 默认: 1000ms (1秒)
SLOW_REQUEST_THRESHOLD_MS=1000

# ============================================
# 优化建议
# ============================================

# 1. 减少内存占用:
#    - 降低 ASSET_PRELOAD_MAX_SIZE (例如: 1MB)
#    - 添加 ASSET_PRELOAD_EXCLUDE_PATTERNS 排除大文件
#
# 2. 提升性能:
#    - 启用 ASSET_PRELOAD_ENABLE_ETAG=true
#    - 启用 ASSET_PRELOAD_ENABLE_GZIP=true
#
# 3. 调试问题:
#    - 设置 ASSET_PRELOAD_VERBOSE_LOGGING=true
#    - 设置 ENABLE_PERF_LOGGING=true
#    - 查看详细的文件加载和请求日志
#
# 4. 生产环境:
#    - ASSET_PRELOAD_VERBOSE_LOGGING=false
#    - ENABLE_PERF_LOGGING=false
#    - NODE_ENV=production
